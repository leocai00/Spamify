<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_5zzs33nboa2a-0>li:before{content:"\0025cf  "}.lst-kix_w5o911w6uwro-8>li:before{content:"-  "}.lst-kix_5zzs33nboa2a-3>li:before{content:"\0025cf  "}.lst-kix_w5o911w6uwro-7>li:before{content:"-  "}.lst-kix_5zzs33nboa2a-1>li:before{content:"\0025cb  "}.lst-kix_5zzs33nboa2a-2>li:before{content:"\0025a0  "}.lst-kix_w5o911w6uwro-6>li:before{content:"-  "}.lst-kix_5zzs33nboa2a-7>li:before{content:"\0025cb  "}.lst-kix_w5o911w6uwro-3>li:before{content:"-  "}ul.lst-kix_5zzs33nboa2a-1{list-style-type:none}ul.lst-kix_5zzs33nboa2a-0{list-style-type:none}ul.lst-kix_5zzs33nboa2a-3{list-style-type:none}.lst-kix_w5o911w6uwro-1>li:before{content:"-  "}.lst-kix_w5o911w6uwro-5>li:before{content:"-  "}ul.lst-kix_5zzs33nboa2a-2{list-style-type:none}.lst-kix_5zzs33nboa2a-8>li:before{content:"\0025a0  "}.lst-kix_5zzs33nboa2a-4>li:before{content:"\0025cb  "}ul.lst-kix_5zzs33nboa2a-5{list-style-type:none}.lst-kix_w5o911w6uwro-0>li:before{content:"-  "}.lst-kix_w5o911w6uwro-4>li:before{content:"-  "}ul.lst-kix_5zzs33nboa2a-4{list-style-type:none}ul.lst-kix_5zzs33nboa2a-7{list-style-type:none}ul.lst-kix_5zzs33nboa2a-6{list-style-type:none}ul.lst-kix_5zzs33nboa2a-8{list-style-type:none}.lst-kix_5zzs33nboa2a-5>li:before{content:"\0025a0  "}.lst-kix_5zzs33nboa2a-6>li:before{content:"\0025cf  "}.lst-kix_w5o911w6uwro-2>li:before{content:"-  "}.lst-kix_7rlni03si0hk-2>li:before{content:"\0025a0  "}.lst-kix_7rlni03si0hk-3>li:before{content:"\0025cf  "}.lst-kix_7rlni03si0hk-4>li:before{content:"\0025cb  "}.lst-kix_7rlni03si0hk-5>li:before{content:"\0025a0  "}ul.lst-kix_w5o911w6uwro-4{list-style-type:none}.lst-kix_7rlni03si0hk-7>li:before{content:"\0025cb  "}.lst-kix_7rlni03si0hk-8>li:before{content:"\0025a0  "}ul.lst-kix_w5o911w6uwro-3{list-style-type:none}ul.lst-kix_w5o911w6uwro-6{list-style-type:none}ul.lst-kix_w5o911w6uwro-5{list-style-type:none}ul.lst-kix_w5o911w6uwro-8{list-style-type:none}.lst-kix_7rlni03si0hk-6>li:before{content:"\0025cf  "}ul.lst-kix_w5o911w6uwro-7{list-style-type:none}ul.lst-kix_w5o911w6uwro-0{list-style-type:none}ul.lst-kix_w5o911w6uwro-2{list-style-type:none}ul.lst-kix_w5o911w6uwro-1{list-style-type:none}ul.lst-kix_7rlni03si0hk-8{list-style-type:none}ul.lst-kix_7rlni03si0hk-7{list-style-type:none}ul.lst-kix_7rlni03si0hk-4{list-style-type:none}ul.lst-kix_7rlni03si0hk-3{list-style-type:none}ul.lst-kix_7rlni03si0hk-6{list-style-type:none}ul.lst-kix_7rlni03si0hk-5{list-style-type:none}ul.lst-kix_7rlni03si0hk-0{list-style-type:none}ul.lst-kix_7rlni03si0hk-2{list-style-type:none}ul.lst-kix_7rlni03si0hk-1{list-style-type:none}.lst-kix_7rlni03si0hk-1>li:before{content:"\0025cb  "}.lst-kix_7rlni03si0hk-0>li:before{content:"\0025cf  "}ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c2{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c8{color:#434343;font-weight:700;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c12{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;text-align:left}.c10{padding-top:14pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;text-align:left}.c11{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c14{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c15{color:inherit;text-decoration:inherit}.c4{font-size:12pt}.c7{height:11pt}.c17{font-size:14pt}.c13{font-size:16pt}.c16{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c14"><div><p class="c1"><span class="c3"></span></p></div><p class="c5"><span class="c13">Analysis of Spam Detection Machine Learning Algorithms</span><span class="c9">&nbsp;</span></p><p class="c5 c7"><span class="c0"></span></p><p class="c5"><span class="c0">Leo Wanxiang Cai, Leon Long</span></p><p class="c5 c7"><span class="c0"></span></p><h3 class="c12" id="h.wjeftansaday"><span class="c8 c17">Introduction</span></h3><p class="c6"><span class="c0">Email is one of the most common ways of communication in the digital era. 269 billion emails were sent and received per day in 2017 (Statista, 2018). However, spam email has become a huge concern for people considering its ubiquity and potential negative impact on individuals and society. According to a report from Statista, 59% of total world emails traffic are spam in September, 2017. &nbsp;With enormous email data for training and computational power, machine learning technology has now become a popular and effective way to identify spam emails. This report discusses the application of three machine learning algorithms (Naive Bayesian, Decision Tree and k-Nearest Neighbors) in the context of spam classification. It compares and contrasts the performance of those three algorithms and evaluate the strengths and weaknesses of each one. </span></p><h3 class="c12" id="h.kvrok5frf740"><span class="c8 c17">Data</span></h3><p class="c6"><span class="c0">For this project, we utilzied a dataset from Stanford OpenClassroom. The dataset contains 960 real email messages. We applied a train-test split of 3:7. The common words like &ldquo;and&rdquo;, &ldquo;the&rdquo; and &ldquo;of&rdquo;, which might cause bias in our models, were removed from the dataframe. Each unique word was assigned to a unique word id, which is considered as an independent feature in our dataframe. In total, there are total 2500 features in our dataframe and a target value that indicates whether an email is spam or not--with 0 representing non spam and 1 representing spam.</span></p><p class="c1"><span class="c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 158.67px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 158.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0"></span></p><h3 class="c12" id="h.7qguhds2zohw"><span class="c16">Algorithms</span></h3><p class="c1"><span class="c3"></span></p><p class="c1"><span class="c0"></span></p><h4 class="c10" id="h.tnw9e5xcx9te"><span class="c2">K-Nearest Neighbors</span></h4><p class="c6"><span class="c0">K-Nearest Neighbors is a lazy learning algorithm. The key principle of this algorithm is to find the nearest distance from the training data points to the new data point, and classify the target data with similar labels. Also, the algorithm is simple to implement and flexible to feature choices. The algorithm is considered as a potential solution for the problem of email spam detection due to its features and functions: it classifies an email based on a similarity measure, like distance matrices. In this particular problem, most of the spam emails may share some similar features. The algorithm determines whether an email is spam or not through the distance of the features of the email to the training data points. The default number of neighbors of the classifier is 5. We tested with the data and find out 1 neighbor has the best performance in our model. The large K value in K-Nearest Neighbors may cause underfitting and high bias in our model, which leads to a low accuracy score. The overall performance of this algorithm is fairly good. </span></p><p class="c1"><span class="c0"></span></p><h4 class="c10" id="h.q9u7wfe1omzv"><span class="c2">Naive Bayes</span></h4><p class="c6"><span class="c4">Naive Bayes is a family of algorithms based on the Bayes Theorem, with strong independence assumptions between the features. It first breaks down a document into tokens, and calculate the probability of the document being identified as a class based on the frequency of each token presented. The algorithm utilizes a posterior probability model, which is to calculate the conditional probability of an event after the relevant </span><span class="c4">evidence</span><span class="c4">&nbsp;or background is taken into account. This makes the algorithm very ideal for supervised machine learning settings such as document classification, since it is relatively easy to obtain well-labeled document datasets for training. In fact, Naive Bayes has been used for text classification for a long history and widely considered as the best algorithm for spam detection. This is resulted from a very core assumption of this algorithm: the value of a particular feature is </span><span class="c4">independent</span><span class="c4">&nbsp;of the value of any other feature, which is a prerequisite for the statistical model behind it. Favorably, in spam detection, every word, as a feature, can be regarded as independent from the rest of the words considering the nature of language. Using </span><span class="c4">Maximum-likelihood</span><span class="c4">&nbsp;can also make the algorithm </span><span class="c4">linear time and highly scalable working with very large email datasets. </span></p><h4 class="c10" id="h.rxqicpxqibou"><span class="c2">Decision Tree</span></h4><p class="c6"><span class="c0">Decision Tree is another algorithm that can be used for classification. A tree is constructed recursively by determining the best split with largest information gain. The branches are labelled with the values of the feature in the parent node. This algorithm could potentially work well with spam detection since the values of the features, which are the frequencies of the words, are discrete numbers. Moreover, unlike Naive Bayes algorithm, by calculating the largest information gain on each node, Decision Tree implicitly performs feature selection on the dataset. The top few nodes are actually the most important variables within the dataset. In other words, it determines the top-classifier words. This can be beneficial in terms of running time considering that we have 2500 features in total. However, without performing smoothing, depth limit, and having a large amount of data ( 2500 words are not enough), the model might result in overfitting.</span></p><h4 class="c10" id="h.ckin4ww5c2b6"><span class="c2">Performance Summary</span></h4><p class="c6"><span>K-Nearest Neighbors:</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 317.00px; height: 71.00px;"><img alt="" src="images/image1.png" style="width: 317.00px; height: 71.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0"></span></p><p class="c6"><span>Naive Bayes</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 321.50px; height: 70.00px;"><img alt="" src="images/image4.png" style="width: 321.50px; height: 70.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0"></span></p><p class="c6"><span>Decision Tree</span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 331.00px; height: 72.00px;"><img alt="" src="images/image5.png" style="width: 331.00px; height: 72.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h3 class="c12" id="h.dvsz6ydl1heo"><span class="c8 c17">Comparison</span></h3><h4 class="c10" id="h.51nxukd8liwx"><span class="c2">Accuracy, Recall, and Precision</span></h4><p class="c6"><span class="c0">Accuracy is the most intuitive performance measurement in data science. Naive Bayes has 0.98 accuracy score, which is the highest score among three algorithms. The accuracy score of Decision Tree is only 0.94. For K Neighbors, the accuracy score drops to 0.91, which is the most accurate algorithm for the problem of spam detection. It is not enough to evaluate the performance of three algorithms only with accuracy. We also applied precision and recall into account in order to comprehensively assess the performance of algorithms. Precision indicates how well a model is out of the total predicted positive observations. Both Naive Bayes and Decision Tree have the same 0.97 precision scores. K Neighbors has the lowest precision score, 0.86. Recall represents the ratio of the actual positives to the true positive. Naive Bayes again has the highest recall score, 0.99. Unexpectedly, K Neighbors has a high recall score, 0.98. We believe that Naive Bayes has the best performance comparing with the other two algorithms, and would be the best solution for spam detection. Naive Bayes works great with high dimensions. The problem of spam detection also satisfies the independence assumption of Naive Bayes. Each word in the email list is independent as a feature of the model. K Neighbors performs worse in spam detection, because K Neighbors does not work well with high dimensions and it is highly sensitive to localized data.</span></p><p class="c1"><span class="c3"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 278.67px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 278.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c3"></span></p><h4 class="c10" id="h.b434mu5dd2m"><span>Running Time</span></h4><p class="c6"><span class="c4">Computational efficiency is also a crucial metrics for assessing machine learning algorithm performance, regarding that good models are usually trained by very large dataset. We performed running time testing on the three algorithms to evaluate their computational friendliness. Despite working with relatively small dataset, they result instructively shows that the running time difference among these algorithms. In total, we used 960 emails, which contain 2500 unique words, for training and testing. Naive Bayes took about 0.05 second, Decision Tree took about 0.09 seconds, and, in contrast, K Nearest Neighbors took about 1.2 seconds. We concluded that K Nearest Neighbors has the least computational efficiency at spam detection. By understanding the mechanism of the algorithm itself, we can better explain the result: for each data point, KNN computes the distances between the point to every other point, which requires O(n)^2 times of distance calculation. The difference will become exponentially noticeable as the dataset grows.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 301.81px; height: 206.50px;"><img alt="" src="images/image2.png" style="width: 301.81px; height: 206.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0"></span></p><p class="c1"><span class="c0"></span></p><h4 class="c10" id="h.hillkg47lrg"><span class="c2">Conclusion</span></h4><p class="c6"><span class="c4">After analyzing the working mechanisms and looking at different performance metrics of the three algorithms, we found that Naive Bayes turned out to be the highest performed algorithm for solving this spam detection problems, with 0.98 accuracy score, 0.99 recall score, and 0.97 precision score. This result can be explained by high dimensions of data and the independent nature of the features: every word in the documents can be considered as independent. On top of that, it has the shortest running time of 0.05 seconds. The use of Maximum-likelihood can help a small number of training data estimate the parameters necessary for classification. On the other hand, K-Nearest Neighbor illustrated its limitation in computation through the relatively large running time. Also, 2500 data points might be considered as sparse for using K-NN most effectively. Besides, Decision Tree also performed very well with discrete values and implicit feature selection in this analysis. </span></p><p class="c1"><span class="c3"></span></p><p class="c6"><span class="c0">By evaluating and analyzing the performance metrics of the three algorithms in the context of spam detection, we have not only successfully selected the best algorithm for solving this particular problem, but also, most importantly, understood that every algorithm performs differently in varied domains regarding its strengths and limitations. We have also practiced the processes and techniques of assessing them and learned to make the right decisions accordingly. &nbsp;In the fancy AI or ML world, technologies, like the various algorithms, are changing rapidly. It is the ability to really understand the problem and choose the right technologies to tackle it, that&rsquo;s going to make fancy technologies as fancy and powerful as it is.</span></p><p class="c1"><span class="c0"></span></p><p class="c1"><span class="c0"></span></p><p class="c6"><span class="c0">Reference:</span></p><p class="c6"><span class="c4">Statista (2018). Number of sent and received e-mails per day worldwide from 2017 to 2022 (in billions), Retrieved from: </span><span class="c11 c4"><a class="c15" href="https://www.google.com/url?q=https://www.statista.com/statistics/456500/daily-number-of-e-mails-worldwide/&amp;sa=D&amp;ust=1526631030798000">https://www.statista.com/statistics/456500/daily-number-of-e-mails-worldwide/</a></span></p><p class="c1"><span class="c0"></span></p><p class="c6"><span class="c4">Stanford OpenClassroom. Ling-Spam Dataset, provided by Ion Androutsopoulos. Retrieved from: </span><span class="c4 c11"><a class="c15" href="https://www.google.com/url?q=http://openclassroom.stanford.edu/MainFolder/DocumentPage.php?course%3DMachineLearning%26doc%3Dexercises/ex6/ex6.html&amp;sa=D&amp;ust=1526631030799000">http://openclassroom.stanford.edu/MainFolder/DocumentPage.php?course=MachineLearning&amp;doc=exercises/ex6/ex6.html</a></span></p><p class="c1"><span class="c0"></span></p><p class="c1"><span class="c0"></span></p></body></html>